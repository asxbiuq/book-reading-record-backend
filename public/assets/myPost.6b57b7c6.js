import{_ as G,g as Q,h as W,G as q,m as c,q as J,E as K,Q as O,R as X,D as v,T as Y,U as H,o as i,c as r,j as u,F as b,x as Z,a as f,e as ee,y as C,z as F,B,I as te,C as y,L as ae,J as oe,K as se,V as ne,W as le,X as ce,Y as ie}from"./index.5e35462e.js";const I=p=>(ce("data-v-69b09c0d"),p=p(),ie(),p),re=I(()=>u("div",{id:"top"},null,-1)),ue={ref:"el",class:"relative top-[5rem]"},de={key:0,class:"flex justify-center"},_e={class:"flex flex-col gap-10 justify-center"},me={key:0},ve={key:1},pe=I(()=>u("p",null,"\u8BF7\u767B\u5F55",-1)),ge=[pe],T=Q({__name:"myPost",setup(p){const g=W(null),l=B(),M=q();c(M,"deletePost");const P=te();let D=J();const{addFav:S,deleteFav:$}=K(),d=O(),_=c(d,"myPosts"),h=c(d,"getMyPosts"),L=c(d,"deleteMyPostFav"),E=c(d,"addMyPostFav"),N=c(d,"deleteMyPost");if(X(_,()=>{console.log("myPosts: ",_.value)}),new Date(l.value.expiryDate).getTime()-new Date().getTime()<0){const{open:e}=v();e("\u767B\u9646\u8BA4\u8BC1\u5DF2\u5931\u6548,\u8BF7\u91CD\u65B0\u767B\u9646"),P.push({name:"Login"})}const w=async()=>{await h.value()};l.value.token||P.push({name:"Login"}),_.value.length||w();const j=async e=>{const{open:t,close:o}=y();t(),l.value.isPending=!0;try{await N.value(e)}catch(s){console.log(s);const{open:m}=v();m(s)}l.value.isPending=!1,o()},V=async e=>{const{open:t,close:o}=y();t(),l.value.isPending=!0;try{e.isFav?(await $(e),await L.value(e)):(await S(e),await E.value(e))}catch(s){console.log(s);const{open:m}=v();m(s)}l.value.isPending=!1,o()},z=e=>{const t=B();t.value.postId=e._id,P.push({name:"Comments",params:{id:e._id}})};Y(()=>{if(g.value)H(g.value);else throw new Error(`target is ${g.value||null}`)});const x=ae(()=>{D.value=!0},1e3);let n=1;const R=async()=>{const{open:e,close:t}=y();e();try{n++,await h.value(n)}catch(o){n--,await h.value(n),console.log(o);const{open:s}=v();s(o)}t()},U=async()=>{const{open:e,close:t}=y();if(e(),n<=1){console.log("The first page!");const{open:o}=v();o("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u9875!")}else n--,await h.value(n),console.log("CurrentPage:",n);t()};return(e,t)=>{const o=oe,s=se,m=ne,A=le;return i(),r(b,null,[re,u("div",ue,[l.value.token?(i(),r("div",de,[u("ul",_e,[(i(!0),r(b,null,Z(_.value,a=>(i(),r("li",{key:a._id},[f(o,{creatorId:a.creator,title:a.title,author:a.author,description:a.content,"btn-name":"\u5220\u9664","img-url":a.imageUrl||"https://images-na.ssl-images-amazon.com/images/I/81WcnNQ-TBL.jpg","is-fav":a.isFav,onClickBtn:k=>j(a),onClickStar:k=>V(a),onClickImage:k=>z(a),class:"post-card hover:scale-105 duration-200 drop-shadow-2xl shadow-2xl bg-blend-color-burn"},null,8,["creatorId","title","author","description","img-url","is-fav","onClickBtn","onClickStar","onClickImage"])]))),128)),_.value.length!==0?(i(),r("div",me,[f(s,{onPagePre:U,onPageNext:R})])):ee("",!0)]),u("div",{ref_key:"target",ref:g,class:"flex justify-center bottom-6 fixed"},[f(m,{onCreated:w})],512)])):(i(),r("div",ve,ge))],512),u("div",{class:"fixed bottom-5 right-5 hover:text-blue-700 cursor-pointer click",onClick:t[0]||(t[0]=(...a)=>C(x)&&C(x)(...a))},[f(A,{style:{"font-size":"2em"}})])],64)}}});typeof F=="function"&&F(T);var fe=G(T,[["__scopeId","data-v-69b09c0d"]]);export{fe as default};
