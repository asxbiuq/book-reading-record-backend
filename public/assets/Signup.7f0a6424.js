import{g as y,h as d,o as A,b as F,w as k,a as v,W as g,j as c,X as S,Y as x,p as E,D,k as h,z as $,A as U}from"./index.1b68d483.js";import{a as P}from"./assign.8ac48471.js";const I=c("div",null,[c("input",{type:"checkbox",checked:"checked",class:"checkbox checkbox-xs"}),c("span",{class:"label-text text-sm"},"\u521B\u5EFA\u5E10\u6237\u5373\u8868\u793A\u60A8\u540C\u610F\u6211\u4EEC\u7684\u6761\u6B3E\u548C\u9690\u79C1")],-1),j=y({__name:"SignupForm",props:{email:null,password:null,name:null},emits:["update:email","update:password","update:name"],setup(u,{emit:m}){const n=d("");return(t,e)=>{const s=S,r=x;return A(),F(r,{"form-label":"\u6CE8\u518C","btn-name":"\u6CE8\u518C"},{default:k(()=>[v(s,{data:u.name,"onUpdate:data":e[0]||(e[0]=a=>g(name)?name.value=a:null),placeholder:"\u7528\u6237\u540D",reg:/^\S{1,10}$/,type:"text","data-tip":"\u7528\u6237\u540D\u957F\u5EA6\u57281-10",value:u.name,onInput:e[1]||(e[1]=a=>t.$emit("update:name",a.target.value))},null,8,["data","value"]),v(s,{data:u.email,"onUpdate:data":e[2]||(e[2]=a=>g(email)?email.value=a:null),placeholder:"\u90AE\u7BB1",reg:/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?/,type:"email","data-tip":"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",value:u.email,onInput:e[3]||(e[3]=a=>t.$emit("update:email",a.target.value))},null,8,["data","reg","value"]),v(s,{data:u.password,"onUpdate:data":e[4]||(e[4]=a=>g(password)?password.value=a:null),placeholder:"\u5BC6\u7801",type:"password",reg:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,20}$/,"data-tip":"\u5BC6\u7801\u81F3\u5C11\u5305\u542B \u6570\u5B57\u548C\u82F1\u6587,\u957F\u5EA66-20",value:u.password,onInput:e[5]||(e[5]=a=>t.$emit("update:password",a.target.value))},null,8,["data","reg","value"]),v(s,{data:n.value,"onUpdate:data":e[6]||(e[6]=a=>n.value=a),dataConfirm:u.password,"onUpdate:dataConfirm":e[7]||(e[7]=a=>g(password)?password.value=a:null),placeholder:"\u786E\u8BA4\u5BC6\u7801",type:"password","data-tip":"\u8BF7\u518D\u6B21\u786E\u8BA4\u5BC6\u7801"},null,8,["data","dataConfirm"]),I]),_:1})}}}),B=d(null),C=d(!1),M=u=>{if(!u)throw new Error(`url is ${u!=null?u:null}`);return{error:B,signup:async(n,t,e)=>{if(!(n||t||e))throw new Error(`email is ${n!=null?n:null}, password is ${t!=null?t:null}, name is ${e!=null?e:null},`);let s,r,a;try{const l=await fetch(u,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:t,name:e})});if(l.status!==200&&l.status!==201){const i=await l.json();throw new Error("\u521B\u5EFA\u7528\u6237\u5931\u8D25!",i.message)}const o=await l.json(),f=24*60*60*1e3;return a=new Date(new Date().getTime()+f).toString(),s=o.userId,r=o.token,B.value=null,C.value=!1,{userId:s,token:r,expiryDate:a}}catch(l){B.value=l.message,C.value=!1}},isPending:C}},R=y({__name:"Signup",setup(u){const m=d(""),n=d(""),t=d(""),s=M("https://express-aliyun-backend-jaiygpwyhp.cn-shanghai.fcapp.run/auth/signup"),r=E(s,"signup"),a=E(s,"error"),l=D(),o=U(),f=async()=>{o.value.isPending=!0;const i=await r.value(m.value,n.value,t.value);if(i)P(o.value,i);else throw new Error(`result is ${i}`);if(!a.value)l.push("/");else throw new Error(`result is ${a.value}`);o.value.isPending=!1};return(i,p)=>{const b=j;return A(),F(b,{email:m.value,"onUpdate:email":p[0]||(p[0]=w=>m.value=w),password:n.value,"onUpdate:password":p[1]||(p[1]=w=>n.value=w),name:t.value,"onUpdate:name":p[2]||(p[2]=w=>t.value=w),novalidate:"",onSubmit:h(f,["prevent"]),class:"form",isPending:o.value.isPending},null,8,["email","password","name","onSubmit","isPending"])}}});typeof $=="function"&&$(R);export{R as default};
