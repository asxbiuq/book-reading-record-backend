import{g as w,h as j,o,c as u,i as J,v as K,j as e,k as O,n as P,b as R,e as z,F as g,_ as L,l as X,t as B,a as x,u as Z,m as A,p,q as ee,s as te,x as F,y as T,w as se,z as I,A as oe,B as b,C}from"./index.1b68d483.js";const ne=["onSubmit"],ae=e("fieldset",{class:"py-4"},[e("input",{type:"submit",value:"\u8BC4\u8BBA",class:"px-4 py-1 bg-sky-600 bg-opacity-[90%] text-white cursor-pointer rounded-2xl"}),e("input",{type:"reset",value:"\u53D6\u6D88",class:"px-4 py-1 bg-white bg-opacity-[90%] border ml-3 cursor-pointer rounded-2xl"})],-1),M=w({__name:"CommentBox",emits:["submit"],setup(a,{emit:s}){let t=j("");const i=()=>{s("submit",t.value),t.value=""};return(r,n)=>(o(),u("form",{class:"grid",onSubmit:O(i,["prevent"])},[J(e("textarea",{"onUpdate:modelValue":n[0]||(n[0]=$=>t.value=$),name:"comment",id:"",placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u8BC4\u8BBA",class:"bg-[#d6d6cb] p-2 rounded bg-opacity-[30%] h-[10rem] border-sky-300 border-[2px] focus-visible:outline-none focus-visible:border-sky-500"},null,512),[[K,t.value]]),ae],40,ne))}}),le=w({__name:"ReplyBox",emits:["submit"],setup(a,{emit:s}){const t=j(!1);return(i,r)=>(o(),u(g,null,[e("button",{class:P(["pt-4 text-blue-600",[t.value?"pb-2":"pb-10"]]),onClick:r[0]||(r[0]=n=>t.value=!t.value)}," \u56DE\u590D ",2),t.value?(o(),R(M,{key:0,class:"mb-4",onSubmit:r[1]||(r[1]=n=>{s("submit",n),t.value=!1})})):z("",!0)],64))}}),re={},ce={class:"pl-8 border-l-2 border-gray-200"};function ue(a,s){return o(),u("div",ce,[X(a.$slots,"default")])}var ie=L(re,[["render",ue]]);const me={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},de=e("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"},null,-1),_e=e("circle",{cx:"12",cy:"5",r:"2",fill:"currentColor"},null,-1),pe=e("circle",{cx:"12",cy:"19",r:"2",fill:"currentColor"},null,-1),ve=[de,_e,pe];function he(a,s){return o(),u("svg",me,ve)}var ye={name:"eva-more-vertical-fill",render:he};const fe={class:"flex"},xe=["src"],be={class:"text-gray-600 text-sm"},Ce={class:"ml-auto"},ge={class:"p-dropdown p-dropdown-left flex"},we={tabindex:"0",class:"m-1 cursor-pointer"},$e={class:"text-gray-600 py-4"},Be=w({__name:"CommentItem",props:{user:{default:"\u533F\u540D\u7528\u6237"},avatar:{default:"https://images-na.ssl-images-amazon.com/images/I/81WcnNQ-TBL.jpg"},time:{default:"\u672A\u77E5\u65F6\u95F4"},content:{default:""}},emits:["deleteComment"],setup(a,{emit:s}){const t=()=>{s("deleteComment")};return(i,r)=>{const n=ye;return o(),u(g,null,[e("div",fe,[e("img",{src:a.avatar,alt:"",class:"w-12 h-12 mr-4 rounded-full"},null,8,xe),e("div",null,[e("p",null,B(a.user),1),e("p",be,B(a.time),1)]),e("span",Ce,[e("div",ge,[e("label",we,[x(n)]),e("ul",{tabindex:"0",class:"p-dropdown-content p-menu shadow relative truncate top-20"},[e("li",null,[e("a",{class:"py-2 hover:bg-red-400 bg-slate-200",onClick:t},"\u5220\u9664")])])])])]),e("p",$e,B(a.content),1)],64)}}}),Re={},De={class:"border-b border-gray-300 my-2 mb-4"};function ke(a,s){return o(),u("div",De)}var Se=L(Re,[["render",ke]]);const Ae={class:"p-4 min-h-screen w-[80vw] max-w-3xl"},Fe={class:"max-w-screen-xl mx-auto p-8 rounded-xl shadow-2xl bg-opacity-25"},Te=e("h2",{class:"text-3xl my-6"},"\u8BC4\u8BBA",-1),Ie=w({__name:"Comments",async setup(a){let s,t,i;const r=Z(),n=A();p(n,"replies"),p(n,"getReplies");const $=p(n,"addReply"),N=p(n,"deleteReply"),y=ee(),D=p(y,"comments"),V=p(y,"addComment"),E=p(y,"deleteComment"),k=p(y,"getComments"),q=p(y,"clearComment"),{clearReplies:H}=A();let S=te();q.value(),H(),r.params.id&&typeof r.params.id=="string"&&!D.value.length?(i=r.params.id,[s,t]=F(()=>k.value(i)),await s,t(),S.value=!0):(i=oe().value.postId,[s,t]=F(()=>k.value(i)),await s,t(),S.value=!0);const Q=async l=>{const{open:h,close:m}=b();h();try{await V.value(l,i)}catch(d){const{open:c}=C();c(d)}l="",m()},U=async(l,h)=>{const{open:m,close:d}=b();m();try{await E.value(l)}catch(c){const{open:f}=C();f(c)}d()},W=async(l,h)=>{const{open:m,close:d}=b();m();try{await $.value(l,h)}catch(c){const{open:f}=C();f(c)}l="",d()},Y=async l=>{const{open:h,close:m}=b();h();try{await N.value(l)}catch(d){const{open:c}=C();c(d)}m()};return(l,h)=>{const m=M,d=Se,c=Be,f=ie,G=le;return o(),u("main",Ae,[e("div",Fe,[Te,x(m,{onSubmit:Q}),x(d),(o(!0),u(g,null,T(D.value,_=>(o(),u("div",{key:_._id},[x(c,{user:_.creator,avatar:"src\\assets\\default avatar.jpg",time:_.time,content:_.content,onDeleteComment:v=>U(_._id,_.content)},null,8,["user","avatar","time","content","onDeleteComment"]),_.replies?(o(),R(f,{key:0},{default:se(()=>[(o(!0),u(g,null,T(_.replies,v=>(o(),R(c,{key:v._id,user:v.creator,avatar:"src\\assets\\default avatar.jpg",time:v.time,content:v.content,onDeleteComment:je=>Y(v)},null,8,["user","avatar","time","content","onDeleteComment"]))),128))]),_:2},1024)):z("",!0),x(G,{onSubmit:v=>W(v,_._id)},null,8,["onSubmit"])]))),128))])])}}});typeof I=="function"&&I(Ie);export{Ie as default};
